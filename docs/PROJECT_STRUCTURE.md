# Project Structure

Complete file tree for MyGamesAnywhere with explanations.

## Repository Root

```
MyGamesAnywhere/
├── .github/              # GitHub-specific files
│   └── workflows/        # CI/CD workflows
│       ├── lint.yml      # Linting workflow
│       ├── test.yml      # Testing workflow
│       └── build.yml     # Build workflow
│
├── docs/                 # Comprehensive documentation
│   ├── ARCHITECTURE.md
│   ├── API.md
│   ├── CODING_STANDARDS.md
│   ├── CURRENT_STATUS.md
│   ├── DATABASE_SCHEMA.md
│   ├── DEPENDENCIES.md
│   ├── DESIGN_DECISIONS.md
│   ├── DEVELOPMENT_SETUP.md
│   ├── PHASE1_DETAILED.md
│   ├── PLUGINS.md
│   ├── PROJECT_STRUCTURE.md
│   └── ROADMAP.md
│
├── packages/             # Client monorepo (Nx workspace)
│   ├── core/            # Shared business logic
│   ├── ui-shared/       # Shared UI components
│   ├── desktop/         # Desktop app
│   └── mobile/          # Mobile app (Phase 2)
│
├── server/               # Go backend
│   ├── cmd/             # Entry points
│   ├── internal/        # Private application code
│   ├── migrations/      # Database migrations
│   ├── Dockerfile
│   ├── docker-compose.yml
│   ├── go.mod
│   ├── go.sum
│   └── Makefile
│
├── .editorconfig         # Editor configuration
├── .gitignore            # Git ignore rules
├── .prettierrc           # Prettier configuration
├── CLAUDE.md             # Guide for Claude Code
├── LICENSE.md            # GPL v3 license
├── README.md             # Project overview
├── nx.json               # Nx configuration
├── package.json          # Root package.json (workspaces)
└── tsconfig.base.json    # Base TypeScript config
```

---

## Server Structure (`server/`)

```
server/
├── cmd/                      # Application entry points
│   └── server/
│       └── main.go           # Server entry point (initializes app)
│
├── internal/                 # Private application code
│   ├── api/                  # HTTP API layer
│   │   ├── handlers/         # HTTP request handlers
│   │   │   ├── auth_handler.go      # Auth endpoints (register, login, etc.)
│   │   │   └── library_handler.go   # Library endpoints (CRUD)
│   │   ├── middleware/       # HTTP middleware
│   │   │   ├── auth.go              # JWT authentication
│   │   │   ├── cors.go              # CORS headers
│   │   │   ├── logger.go            # Request logging
│   │   │   └── recovery.go          # Panic recovery
│   │   ├── requests/         # Request DTOs
│   │   │   ├── auth_requests.go     # RegisterRequest, LoginRequest, etc.
│   │   │   └── library_requests.go  # CreateLibraryRequest, etc.
│   │   ├── responses/        # Response DTOs
│   │   │   ├── auth_responses.go    # LoginResponse, UserResponse, etc.
│   │   │   ├── library_responses.go # LibraryResponse, etc.
│   │   │   └── error_response.go    # ErrorResponse (standard format)
│   │   └── router.go         # Route setup and registration
│   │
│   ├── config/               # Configuration management
│   │   └── config.go         # Load and validate config from env
│   │
│   ├── db/                   # Database layer
│   │   ├── queries/          # SQL queries (for sqlc)
│   │   │   ├── users.sql            # User queries (SELECT, INSERT, etc.)
│   │   │   └── libraries.sql        # Library queries
│   │   ├── db.go             # Database connection setup
│   │   └── sqlc.yaml         # sqlc configuration
│   │
│   ├── models/               # Database models (generated by sqlc)
│   │   ├── models.go         # Base types (UUID, timestamps, etc.)
│   │   ├── users.sql.go      # User queries implementation
│   │   └── libraries.sql.go  # Library queries implementation
│   │
│   ├── services/             # Business logic layer
│   │   ├── auth_service.go      # Auth business logic
│   │   │                         # - RegisterUser()
│   │   │                         # - LoginUser()
│   │   │                         # - RefreshToken()
│   │   ├── library_service.go   # Library business logic
│   │   │                         # - CreateLibrary()
│   │   │                         # - GetUserLibraries()
│   │   │                         # - UpdateLibrary()
│   │   │                         # - DeleteLibrary()
│   │   ├── jwt_service.go       # JWT token handling
│   │   │                         # - GenerateToken()
│   │   │                         # - ValidateToken()
│   │   │                         # - ParseToken()
│   │   └── errors.go            # Custom error types
│   │                             # - DetailedError
│   │                             # - ValidationError
│   │                             # - NotFoundError
│   │
│   └── validators/           # Input validation
│       ├── auth_validator.go     # Email, password, username validation
│       └── library_validator.go  # Library name, description validation
│
├── migrations/               # Database migrations (golang-migrate)
│   ├── 000001_create_users.up.sql
│   ├── 000001_create_users.down.sql
│   ├── 000002_create_libraries.up.sql
│   └── 000002_create_libraries.down.sql
│
├── .env.example              # Example environment variables
├── .gitignore                # Go-specific ignores
├── Dockerfile                # Docker image definition
├── docker-compose.yml        # Local development (PostgreSQL)
├── go.mod                    # Go module definition
├── go.sum                    # Go module checksums
└── Makefile                  # Common tasks (build, test, migrate)
```

### Key Files Explained

**`cmd/server/main.go`**
- Entry point for the server
- Initializes configuration
- Sets up database connection
- Initializes services
- Sets up router with middleware
- Starts HTTP server

**`internal/api/router.go`**
- Defines all API routes
- Groups routes by resource
- Applies middleware
- Mounts handlers

**`internal/services/*.go`**
- Business logic (not HTTP-specific)
- Called by handlers
- Uses DB layer (sqlc generated code)
- Returns domain errors

**`internal/db/queries/*.sql`**
- SQL queries written by hand
- sqlc generates type-safe Go code
- One file per entity

---

## Client Structure (`packages/`)

### Core Package (`packages/core/`)

Shared business logic used by both desktop and mobile.

```
packages/core/
├── src/
│   ├── api/                  # API communication layer
│   │   ├── client.ts         # Axios instance with interceptors
│   │   ├── auth.api.ts       # Auth API calls (register, login, etc.)
│   │   └── libraries.api.ts  # Library API calls (CRUD)
│   │
│   ├── models/               # TypeScript types/classes
│   │   ├── User.ts           # User model
│   │   ├── Library.ts        # Library model
│   │   └── ApiError.ts       # API error model
│   │
│   ├── stores/               # Zustand stores
│   │   ├── useAuthStore.ts   # Auth state (user, token, login, logout)
│   │   └── useLibraryStore.ts # Library state (libraries, CRUD actions)
│   │
│   ├── utils/                # Shared utilities
│   │   ├── validation.ts     # Zod validation schemas
│   │   ├── errors.ts         # Error handling utilities
│   │   └── storage.ts        # LocalStorage wrapper
│   │
│   └── index.ts              # Public API exports
│
├── package.json              # Package dependencies
├── tsconfig.json             # TypeScript config
└── vite.config.ts            # Vite config (for testing)
```

### UI Shared Package (`packages/ui-shared/`)

Reusable UI components for desktop and mobile.

```
packages/ui-shared/
├── src/
│   ├── components/           # Shared components
│   │   ├── Button/
│   │   │   ├── Button.tsx           # Button component
│   │   │   ├── Button.test.tsx      # Tests
│   │   │   └── Button.module.css    # Styles (if needed)
│   │   ├── Input/
│   │   │   ├── Input.tsx            # Input component
│   │   │   └── Input.test.tsx
│   │   ├── Modal/
│   │   │   ├── Modal.tsx            # Modal component
│   │   │   └── Modal.test.tsx
│   │   ├── ErrorMessage/
│   │   │   ├── ErrorMessage.tsx
│   │   │   └── ErrorMessage.test.tsx
│   │   └── LoadingSpinner/
│   │       ├── LoadingSpinner.tsx
│   │       └── LoadingSpinner.test.tsx
│   │
│   ├── hooks/                # Custom React hooks
│   │   ├── useDebounce.ts
│   │   └── useLocalStorage.ts
│   │
│   ├── theme/                # Design system
│   │   ├── colors.ts         # Color palette
│   │   ├── typography.ts     # Font definitions
│   │   └── spacing.ts        # Spacing scale
│   │
│   └── index.ts              # Public API exports
│
├── package.json
├── tsconfig.json
└── vite.config.ts
```

### Desktop Package (`packages/desktop/`)

Desktop-specific application code.

```
packages/desktop/
├── src/
│   ├── components/           # Desktop-specific components
│   │   ├── Layout/
│   │   │   ├── Header.tsx           # App header (user menu, logo)
│   │   │   ├── Sidebar.tsx          # Navigation sidebar
│   │   │   └── Layout.tsx           # Main layout wrapper
│   │   └── ProtectedRoute.tsx      # Auth-required route wrapper
│   │
│   ├── pages/                # Page components (routes)
│   │   ├── auth/
│   │   │   ├── RegisterPage.tsx     # Registration form
│   │   │   └── LoginPage.tsx        # Login form
│   │   ├── libraries/
│   │   │   ├── LibrariesPage.tsx    # Library list
│   │   │   └── CreateLibraryDialog.tsx
│   │   └── NotFoundPage.tsx         # 404 page
│   │
│   ├── App.tsx               # Root component
│   ├── main.tsx              # Entry point
│   └── routes.tsx            # Route definitions
│
├── public/                   # Static assets
│   ├── favicon.ico
│   └── logo.png
│
├── capacitor.config.ts       # Capacitor configuration
├── index.html                # HTML entry point
├── package.json              # Package dependencies
├── tailwind.config.js        # TailwindCSS config
├── vite.config.ts            # Vite config
└── tsconfig.json             # TypeScript config
```

### Mobile Package (`packages/mobile/`)

Mobile-specific application code (Phase 2).

```
packages/mobile/
├── src/
│   ├── components/           # Mobile-specific components
│   ├── pages/                # Mobile pages
│   ├── App.tsx
│   ├── main.tsx
│   └── routes.tsx
│
├── android/                  # Android native project
├── ios/                      # iOS native project
├── public/
├── capacitor.config.ts
├── index.html
├── package.json
└── tsconfig.json
```

---

## Import Paths

### Internal Imports (Server)

```go
// From cmd/server/main.go
import (
    "github.com/GreenFuze/MyGamesAnywhere/server/internal/api"
    "github.com/GreenFuze/MyGamesAnywhere/server/internal/config"
    "github.com/GreenFuze/MyGamesAnywhere/server/internal/db"
    "github.com/GreenFuze/MyGamesAnywhere/server/internal/services"
)

// From internal/api/handlers/auth_handler.go
import (
    "github.com/GreenFuze/MyGamesAnywhere/server/internal/models"
    "github.com/GreenFuze/MyGamesAnywhere/server/internal/services"
    "github.com/GreenFuze/MyGamesAnywhere/server/internal/api/requests"
    "github.com/GreenFuze/MyGamesAnywhere/server/internal/api/responses"
)
```

### Package Imports (Client)

Nx workspaces use path aliases defined in `tsconfig.base.json`:

```json
{
  "compilerOptions": {
    "paths": {
      "@mygamesanywhere/core": ["packages/core/src/index.ts"],
      "@mygamesanywhere/ui-shared": ["packages/ui-shared/src/index.ts"],
      "@mygamesanywhere/desktop": ["packages/desktop/src/index.ts"]
    }
  }
}
```

**Usage:**

```typescript
// From packages/desktop/src/pages/auth/LoginPage.tsx
import { useAuthStore } from '@mygamesanywhere/core';
import { Button, Input } from '@mygamesanywhere/ui-shared';

// From packages/core/src/stores/useAuthStore.ts
import { authApi } from '../api/auth.api';
import { User } from '../models/User';
```

---

## File Naming Conventions

### Server (Go)

- **Files:** `snake_case.go` (e.g., `auth_handler.go`, `jwt_service.go`)
- **Types:** `PascalCase` (e.g., `type AuthService struct {}`)
- **Functions:** `PascalCase` for exported, `camelCase` for private
- **Constants:** `PascalCase` or `SCREAMING_SNAKE_CASE`

### Client (TypeScript)

- **Files:** `PascalCase.tsx` for components, `camelCase.ts` for utilities
- **Components:** `PascalCase` (e.g., `LoginPage.tsx`, `Button.tsx`)
- **Utilities:** `camelCase` (e.g., `validation.ts`, `errors.ts`)
- **Types/Interfaces:** `PascalCase` (e.g., `User`, `Library`)
- **Functions:** `camelCase`
- **Constants:** `SCREAMING_SNAKE_CASE`

---

## Module Organization

### Server

**One file per handler/service:**
- `auth_handler.go` - All auth endpoints
- `library_handler.go` - All library endpoints
- `auth_service.go` - All auth business logic

**Group related code:**
- All handlers in `internal/api/handlers/`
- All services in `internal/services/`
- All middleware in `internal/api/middleware/`

### Client

**Component folders:**
```
Button/
├── Button.tsx        # Component
├── Button.test.tsx   # Tests
└── Button.module.css # Styles (if needed, prefer Tailwind)
```

**Page components:**
- One file per page
- Complex pages can have subfolder with components

**Store per domain:**
- `useAuthStore.ts` - All auth-related state
- `useLibraryStore.ts` - All library-related state

---

## Configuration Files

### Root Level

**`package.json`** (root)
```json
{
  "name": "mygamesanywhere",
  "private": true,
  "workspaces": ["packages/*"],
  "scripts": {
    "dev:desktop": "nx serve desktop",
    "build:desktop": "nx build desktop",
    "test": "nx run-many --target=test --all",
    "lint": "nx run-many --target=lint --all"
  }
}
```

**`nx.json`**
```json
{
  "targetDefaults": {
    "build": {
      "dependsOn": ["^build"],
      "cache": true
    },
    "test": {
      "cache": true
    }
  },
  "namedInputs": {
    "default": ["{projectRoot}/**/*"],
    "production": ["!{projectRoot}/**/*.test.ts"]
  }
}
```

**`tsconfig.base.json`**
```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ESNext",
    "moduleResolution": "bundler",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "paths": {
      "@mygamesanywhere/core": ["packages/core/src/index.ts"],
      "@mygamesanywhere/ui-shared": ["packages/ui-shared/src/index.ts"]
    }
  }
}
```

---

## Build Outputs

### Server

```
server/
├── bin/              # Compiled binaries (gitignored)
│   └── server        # Built executable
```

### Client

```
packages/desktop/
├── dist/             # Build output (gitignored)
│   ├── index.html
│   └── assets/
├── dist-electron/    # Electron build (gitignored)
└── node_modules/     # Dependencies (gitignored)
```

---

## Summary

**Server:** Clean architecture with clear separation (handlers → services → db)

**Client:** Nx monorepo with shared packages for maximum code reuse

**Imports:** Path aliases make cross-package imports clean

**Naming:** Consistent conventions across languages

See [PHASE1_DETAILED.md](./PHASE1_DETAILED.md) for implementation details and [DEPENDENCIES.md](./DEPENDENCIES.md) for package versions.
